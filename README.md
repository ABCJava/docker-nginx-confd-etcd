# nginx-confd-etcd

[Dockerfile](https://github.com/tarhelypark/nginx-confd-etcd/blob/master/Dockerfile)

[Docker](https://www.docker.com/) container for [confd](https://github.com/kelseyhightower/confd) configured [nginx](http://nginx.org/) based on [etcd](https://coreos.com/docs/distributed-configuration/getting-started-with-etcd/) values generated by [Registrator](https://github.com/gliderlabs/registrator). Mainly for [CoreOS](https://coreos.com/) cluster.

## Pre-Requirements for cluster configuration

This docker image made for CoreOs cluster. You need working Registrators on every cluster nodes.

# How to use this image

`docker run --name nginx.abc.ordina.nl -p 80:80 -e NGINX_BACKEND_SERVICE=abc.ordina.nl -e HOST_IP=127.0.0.1 -e ETCD_PORT=4001 abcjava/nginx-confd-etcd`

The following environment variables available:

-	`-e NGINX_BACKEND_SERVICE=...` (name of backend service instance, example.com in our example)
-	`-e HOST_IP=...` (IP of etcd)
- `-e ETCD_PORT=...` (public port of etcd default: 4001)
- `-e NGINX_WORKER_PROCESSES=...` (number of nginx worker processes, default: cpu x 2)

# Usefull links
* [CoreOS Quickstart quide](https://coreos.com/docs/quickstart/)
* [CoreOS](https://coreos.com/)
* [Docker](https://www.docker.com/)
* [Registrator](https://github.com/gliderlabs/registrator)
* [confd](https://github.com/kelseyhightower/confd)
* [DigitalOcean Confd and Etcd](https://www.digitalocean.com/community/tutorials/how-to-use-confd-and-etcd-to-dynamically-reconfigure-services-in-coreos
)
